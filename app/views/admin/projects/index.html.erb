<div class="container-fluid box box-info ">
  <div class="box-header with-border">
    <h3>
      Gérer les projets
      <span class="block-title_link pull-right">
        <%= link_to "<i class='fa fa-plus'></i> Ajouter un projet ".html_safe, new_admin_project_url %>
      </span>
    </h3>
  </div>
  <div class="box-body">
    <table id="projectsTable" class="table table-hover table-striped table-responsive table-condensed no-margin">
      <thead>
        <tr>
          <th>
            Nom du projet
          </th>
          <th>
            En ligne ?
          </th>
          <th>
            Catégorie
          </th>
          <th>
            Lieu
          </th>
          <th>
            Crée le
          </th>
          <th>
            Par
          </th>
          <th>
            Avancement
          </th>
          <th>
            Labélisé?
          </th>
          <th>
            Actions
          </th>
        </tr>
      </thead>
      <tbody>
        <% @projects.each do | project | %>
          <tr>
            <td>
              <h5><%= truncate(project.name.html_safe) %></h5>
            </td>
            <td>
              <%= form_tag admin_projectpublish_url do %>
                  <%= hidden_field_tag "id", project.id %>
                  <% if project.published %>
                    <%= submit_tag "Oui", class: "btn btn-success" %>
                  <% else %>
                    <%= submit_tag "Non", class: "btn btn-danger" %>
                  <% end %>
                <% end %>
                </td>
            <td>
              <%= project.category.name %>
            </td>
            <td>
              <%= project.location %>
            </td>
            <td>
              <%= time_tag project.created_at, format: :morejformat %>
            </td>
            <td>
              <%= project.owner.username %>
            </td>
            <td>
              <%= project.state %>
            </td>
            <td>
                <%= form_tag admin_projectlabelize_url do %>
                <%= hidden_field_tag "id", project.id %>
                <% if project.labelized %>
                  <%= submit_tag "Oui", class: "btn btn-success" %>
                <% else %>
                  <%= submit_tag "Non", class: "btn btn-danger" %>
                <% end %>
              <% end %>
            </td>
            <td>
              <%= link_to "<i class='fa fa-pencil'></i>".html_safe, edit_admin_project_url(project.friendly_id), class:'btn btn-warning'%>
              <%= link_to "<i class='fa fa-trash-o'></i>".html_safe, admin_project_url(project.friendly_id), method: "delete", class:'btn btn-danger'%>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
<style type= "text/css">
  th, td {
    text-align: center;
  }
</style>
<script>
  $(document).ready(function(){
    $('#projectsTable').DataTable({
            "responsive": true,
            "sScrollX": false, // retrait de la barre de scroll horizontale en responsive
            "language": { // mise en Français du pluggin.
                "sProcessing": "Traitement en cours...",
                "sSearch": "Rechercher&nbsp;:",
                "sLengthMenu": "Afficher _MENU_ &eacute;l&eacute;ments",
                "sInfo": "Affichage de l'&eacute;l&eacute;ment _START_ &agrave; _END_ sur _TOTAL_ &eacute;l&eacute;ments",
                "sInfoEmpty": "Affichage de l'&eacute;l&eacute;ment 0 &agrave; 0 sur 0 &eacute;l&eacute;ment",
                "sInfoFiltered": "(filtr&eacute; de _MAX_ &eacute;l&eacute;ments au total)",
                "sInfoPostFix": "",
                "sLoadingRecords": "Chargement en cours...",
                "sZeroRecords": "Aucun &eacute;l&eacute;ment &agrave; afficher",
                "sEmptyTable": "Aucune donn&eacute;e disponible dans le tableau",
                "oPaginate": {
                    "sFirst": "Premier",
                    "sPrevious": "Pr&eacute;c&eacute;dent",
                    "sNext": "Suivant",
                    "sLast": "Dernier"
                },

                "oAria": {
                    "sSortAscending": ": activer pour trier la colonne par ordre croissant",
                    "sSortDescending": ": activer pour trier la colonne par ordre d&eacute;croissant"
                }
            },
            "pageLength": 25, // Affichage de 100 éléments de base au chargement de la page
            "lengthMenu": [ [25, 50, 100, 1000, -1], [25, 50, 100, 1000, "tous les"] ], // Changement du menu de base pour la sélection de l'affichage du nombre d'éléments : [nombres d'éléments à afficher] [libellés]
            "order": [[1, 'asc']]
        });
  });
</script>
